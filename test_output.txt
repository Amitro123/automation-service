============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.0, pluggy-1.6.0 -- C:\Users\USER\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\USER\AutomationService\automation-service
configfile: pytest.ini
plugins: anyio-4.11.0, logfire-4.14.2, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 4 items

tests/test_code_reviewer.py::test_review_commit_success FAILED           [ 25%]
tests/test_code_reviewer.py::test_review_commit_no_diff FAILED           [ 50%]
tests/test_code_reviewer.py::test_review_commit_llm_failure FAILED       [ 75%]
tests/test_code_reviewer.py::test_review_commit_post_as_issue FAILED     [100%]

================================== FAILURES ===================================
_________________________ test_review_commit_success __________________________

code_reviewer = <src.automation_agent.code_reviewer.CodeReviewer object at 0x000001820FBF5750>
github_client = <automation_agent.github_client.GitHubClient object at 0x000001820FC54290>
mock_llm_client = <AsyncMock spec='LLMClient' id='1658121963792'>

    @pytest.mark.asyncio
    async def test_review_commit_success(code_reviewer, github_client, mock_llm_client):
        """Test successful code review."""
        # Setup mocks
>       github_client.get_commit_diff.return_value = "diff content"
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'method' object has no attribute 'return_value'

tests\test_code_reviewer.py:13: AttributeError
_________________________ test_review_commit_no_diff __________________________

code_reviewer = <src.automation_agent.code_reviewer.CodeReviewer object at 0x000001820F889D10>
github_client = <automation_agent.github_client.GitHubClient object at 0x000001820FC55E10>

    @pytest.mark.asyncio
    async def test_review_commit_no_diff(code_reviewer, github_client):
        """Test review when diff fetch fails."""
>       github_client.get_commit_diff.return_value = None
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'method' object has no attribute 'return_value'

tests\test_code_reviewer.py:35: AttributeError
_______________________ test_review_commit_llm_failure ________________________

code_reviewer = <src.automation_agent.code_reviewer.CodeReviewer object at 0x000001820CE7A250>
github_client = <automation_agent.github_client.GitHubClient object at 0x000001820FD11A90>
mock_llm_client = <AsyncMock spec='LLMClient' id='1658122741776'>

    @pytest.mark.asyncio
    async def test_review_commit_llm_failure(code_reviewer, github_client, mock_llm_client):
        """Test review when LLM analysis fails."""
>       github_client.get_commit_diff.return_value = "diff content"
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'method' object has no attribute 'return_value'

tests\test_code_reviewer.py:44: AttributeError
______________________ test_review_commit_post_as_issue _______________________

code_reviewer = <src.automation_agent.code_reviewer.CodeReviewer object at 0x000001820F29D910>
github_client = <automation_agent.github_client.GitHubClient object at 0x000001820FD25510>
mock_llm_client = <AsyncMock spec='LLMClient' id='1658122822672'>

    @pytest.mark.asyncio
    async def test_review_commit_post_as_issue(code_reviewer, github_client, mock_llm_client):
        """Test posting review as an issue."""
>       github_client.get_commit_diff.return_value = "diff content"
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       AttributeError: 'method' object has no attribute 'return_value'

tests\test_code_reviewer.py:55: AttributeError
=========================== short test summary info ===========================
FAILED tests/test_code_reviewer.py::test_review_commit_success - AttributeErr...
FAILED tests/test_code_reviewer.py::test_review_commit_no_diff - AttributeErr...
FAILED tests/test_code_reviewer.py::test_review_commit_llm_failure - Attribut...
FAILED tests/test_code_reviewer.py::test_review_commit_post_as_issue - Attrib...
============================== 4 failed in 0.33s ==============================
